import{Q as O,a as B,b as L,c as T}from"./QItemLabel.8c38a0ab.js";import{G as P,a as W,r as i,q as $,at as w,J as s,T as c,N as _,M as r,L as m,I as v,al as g,V as j,K as x,X as G,t as J,ay as K,P as S,ah as I,O as U,R as X,S as D}from"./index.6907c00b.js";import{q as H,a as Y,c as Z,o as ee,d as V,e as R,u as C}from"./firebase.02bcd041.js";import{g as ae,r as le,u as te,a as se}from"./index.esm2017.601a6a60.js";const ne=["src"],oe=["src"],ue=["src"],ie=["src"],de={class:"text-grey-7"},pe={__name:"MuhammadAmin",setup(ce){const q=P(),E=()=>{q.go(-1)};let y=W(()=>!!q.currentRoute.value.fullPath.includes("/admin"));const e=i();let d=i(!1);const n=i([]);$(()=>{const t=H(Z(V,"active"),Y("date"));ee(t,a=>{a.docChanges().forEach(l=>{let p=l.doc.data();if(p.id=l.doc.id,l.type==="added"&&(n.value.unshift(p),e.value=n.value[1]),l.type==="modified"){let k=n.value.findIndex(b=>b.id===p.id);console.log("modified",p),Object.assign(n.value[k],p),k===1&&(e.value=n.value[1])}if(l.type==="removed"){let k=n.value.findIndex(b=>b.id===p.id);n.value.splice(k,1),k===1&&(e.value=n.value[1])}})})});const M=i(null),N=()=>{y?M.value.click():console.log("dnx")},z=ae(),A=async t=>{const a=le(z,`videos/${t.name}`);return await te(a,t),await se(a)};let f=i(),h=i();const F=t=>{const a=t.target.files[0];if(a){const l=new FileReader;l.onload=async()=>{a.type.startsWith("image")?(f.value=null,h.value=l.result):a.type.startsWith("video")&&(h.value=null,f.value=await A(f.value=t.target.files[0]))},l.readAsDataURL(a)}Q()};let o=i("");w(()=>{e.value&&(o.value=e.value.nickname)}),w(()=>{if(e.value&&o.value!==e.value.nickname){const t=R(V,"active",e.value.id);C(t,{nickname:o.value}).then(()=>{e.value.nickname=o.value}).catch(a=>{console.error("Error updating nickname:",a)})}});let u=i("");w(()=>{e.value&&(u.value=e.value.name)}),w(()=>{if(e.value&&u.value!==e.value.name){const t=R(V,"active",e.value.id);C(t,{name:u.value}).then(()=>{e.value.name=u.value}).catch(a=>{console.error("Error updating nickname:",a)})}});const Q=async()=>{if(f.value||h.value){const t=R(V,"active","M");await C(t,{image:f.value||h.value})}else console.log("zhdi"),setInterval(async()=>{await f.value,Q()},1e3)};return(t,a)=>(s(),c(j,null,[_("div",{onClick:E,color:"primary",class:"backti"}," \u2190 "),r(O,{class:"q-ml-md lflex",padding:""},{default:m(()=>[e.value?(s(),x(B,{key:0,class:"mag"},{default:m(()=>[e.value.image.includes("https")?(s(),c("video",{key:1,class:"dodimga",loop:"",autoplay:"",muted:"",src:e.value.image},null,8,oe)):(s(),c("img",{key:0,class:"dodimga",src:e.value.image},null,8,ne))]),_:1})):g("",!0),e.value?(s(),x(B,{key:1,class:"fayz q-py-md"},{default:m(()=>[r(L,{avatar:"",top:"",onClick:N},{default:m(()=>[_("div",{class:"image-wrapper",onMouseover:a[0]||(a[0]=l=>I(d)?d.value=!0:d=!0),onMouseleave:a[1]||(a[1]=l=>I(d)?d.value=!1:d=!1)},[r(G,{appear:"","enter-active-class":"animated fadeIn slow","leave-active-class":"animated fadeOut slow"},{default:m(()=>[J(r(S,{class:"camera-icon",name:"camera_alt"},null,512),[[K,v(d)]])]),_:1}),e.value.image.includes("https")?(s(),c("video",{key:1,class:"dodemg",loop:"",autoplay:"",muted:"",src:e.value.image},null,8,ie)):(s(),c("img",{key:0,class:"dodemg",src:e.value.image},null,8,ue))],32)]),_:1}),r(L,null,{default:m(()=>[r(T,{class:"text-subtitle1 column"},{default:m(()=>[_("div",null,[_("strong",null,U(e.value.nickname),1)]),_("span",de,U(e.value.name),1)]),_:1})]),_:1})]),_:1})):g("",!0),v(y)?(s(),c("button",{key:2,onClick:N,class:"bit"},[X("Change pfp "),r(S,{class:"qicon",name:"camera_alt"})])):g("",!0),v(y)?(s(),x(D,{key:3,standout:"bg-teal text-white",class:"mai",modelValue:v(o),"onUpdate:modelValue":a[2]||(a[2]=l=>I(o)?o.value=l:o=l),label:"nick-name"},null,8,["modelValue"])):g("",!0),v(y)?(s(),x(D,{key:4,standout:"bg-teal text-white",class:"mai",modelValue:v(u),"onUpdate:modelValue":a[3]||(a[3]=l=>I(u)?u.value=l:u=l),label:"nick-name"},null,8,["modelValue"])):g("",!0)]),_:1}),v(y)?(s(),c("input",{key:0,type:"file",onChange:F,style:{display:"none"},ref_key:"imageInput",ref:M,accept:"image/*, video/*"},null,544)):g("",!0)],64))}};export{pe as default};
