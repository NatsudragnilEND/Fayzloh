import{a as M,Q as E,b as Q,c as _}from"./QItemLabel.8c38a0ab.js";import{r as m,G as Z,q as R,at as ee,J as n,T as d,M as s,L as o,al as u,V as U,R as F,N as i,O as c,K as f,Q as h,au as ae,I as g,S as le,ah as te,aj as se,ak as oe,U as ie,am as A}from"./index.6907c00b.js";import{Q as O}from"./QAvatar.3b23fbd4.js";import{Q as ne}from"./QImg.4d80ecd1.js";import{Q as de,f as ue}from"./formatDistance.04543f57.js";import{e as x,d as v,l as ce,q as N,a as T,c as S,o as W,f as V,b as re,u as $}from"./firebase.02bcd041.js";import{g as me,r as fe,u as ve,a as ye}from"./index.esm2017.601a6a60.js";import"./QScrollObserver.f842e0c0.js";var pe="/images/fayz.jpg";const _e={key:0},he=["src"],ge=["src"],ke={class:"text-grey-7"},we=["src"],ze=["src"],be={class:"fayz-icons row justify-between q-mt-sm"},Fe={class:"likes-value"},xe={key:0},Ce={key:1},De={key:0},Qe={key:0},Se={class:"q-py-lg row items-center"},qe=["src"],Ie={class:"gapp"},Me={class:"input-file"},Re=i("span",null,"Add file",-1),Ae={class:"col col-2"},Ne={key:0,class:"fayz q-py-md"},Ve={class:"text-grey-7"},Le=["src"],je=["src"],Be={class:"fayz-icons row justify-between q-mt-sm"},Ee={class:"likes-value"},Ue={key:0},Oe={key:1},Ye={__name:"Message",setup(Te){const a=m(null),L=Z(),j=l=>ue(l,new Date),k=L.currentRoute.value.params;let y=m(""),q=m(!1),w=m(null);const z=m([]);m(!1);let C=m(!1),p=m();const G=me(),B=async l=>{const t=fe(G,`videos/${l.name}`);return await ve(t,l),await ye(t)};setInterval(()=>{localStorage.setItem("lastActiveF",Date.now())},100);const K=async()=>{if(y.value!==""||w.value||p.value){q.value=!1;let l={content:y.value,date:Date.now(),liked:0,image:C.value?"/images/logo.png":"/images/fayz.jpg",images:w.value,video:null,admin:C.value,nickname:C.value?"MuhammadAmin":"Fayzulloh",name:C.value?"@Natsu_Dragnil_END":"@Kenma",MuhammadAmin:!1,Fayzulloh:!1,num:String(k.id)};p.value&&(l.video=await B(p.value));const t=await re(S(v,"fayzstu"),l);console.log("Document written with ID: ",t.id)}else return null;y.value="",w.value=null,p.value=null,q.value=!1},J=l=>{const t=l.target.files[0];if(t){const e=new FileReader;e.onload=async()=>{t.type.startsWith("image")?(p.value=null,w.value=e.result):t.type.startsWith("video")&&(w.value=null,p.value=await B(p.value=l.target.files[0]))},e.readAsDataURL(t)}};R(async()=>{const l=x(v,"fayzs",k.id),t=await ce(l);t.exists()?a.value=t.data():console.log("No such document!"),console.log(a.value)});const P=async()=>{if(a.value){const l=x(v,"fayzs",k.id);await $(l,{liked:a.value.Fayzulloh?a.value.liked-1:a.value.liked+1,Fayzulloh:!a.value.Fayzulloh})}},H=async()=>{a.value&&await V(x(v,"fayzs",k.id))},X=async l=>{(!l.liked||isNaN(l.liked))&&(l.liked=0);const t=l.Fayzulloh?l.liked-1:l.liked+1,e=x(v,"fayzstu",l.id);await $(e,{liked:t,Fayzulloh:!l.Fayzulloh})},Y=async l=>{a.value&&await V(x(v,"fayzstu",l.id))};R(()=>{const l=N(S(v,"fayzs"),T("date"));W(l,t=>{t.docChanges().forEach(async e=>{let r=e.doc.data();r.id=e.doc.id,e.type,e.type==="modified"&&Object.assign(a.value,r),e.type==="removed"&&((await getDocs(N(S(v,"fayzstu"),where("num","==",String(k.id))))).forEach(async b=>{await V(b.ref)}),L.push("/admin"))})})}),R(()=>{const l=N(S(v,"fayzstu"),T("date"));W(l,t=>{t.docChanges().forEach(e=>{let r=e.doc.data();if(r.id=e.doc.id,e.type==="added"&&z.value.unshift(r),e.type==="modified"){let D=z.value.findIndex(b=>b.id===r.id);Object.assign(z.value[D],r)}if(e.type==="removed"){let D=z.value.findIndex(b=>b.id===r.id);z.value.splice(D,1)}})})});let I=m(!1);return ee(()=>{window.innerWidth<1e3?I.value=!0:I.value=!1}),(l,t)=>(n(),d(U,null,[s(M,{to:"/",color:"primary",class:"back"},{default:o(()=>[F(" \u2190 ")]),_:1}),a.value?(n(),d("div",_e,[s(E,{separator:""},{default:o(()=>[s(M,{class:"fayz q-py-md"},{default:o(()=>[s(Q,{avatar:"",top:""},{default:o(()=>[a.value.image.includes("https")?(n(),d("video",{key:1,onClick:t[1]||(t[1]=(...e)=>l.pushim&&l.pushim(...e)),class:"dodemg",loop:"",autoplay:"",muted:"",src:a.value.image},null,8,ge)):(n(),d("img",{key:0,onClick:t[0]||(t[0]=(...e)=>l.pushim&&l.pushim(...e)),class:"dodemg",src:a.value.image},null,8,he))]),_:1}),s(Q,null,{default:o(()=>[s(_,{class:"text-subtitle1 column"},{default:o(()=>[i("strong",null,c(a.value.nickname),1),i("span",ke,c(a.value.name)+" \u2022 "+c(j(a.value.date)),1)]),_:1}),a.value.content?(n(),f(_,{key:0,class:"text-body1 fayz-content"},{default:o(()=>[F(c(a.value.content),1)]),_:1})):u("",!0),a.value.video?(n(),f(_,{key:1,class:"text-body1 maha fayz-content"},{default:o(()=>[i("video",{controls:"",class:"maha",src:a.value.video},null,8,we)]),_:1})):u("",!0),a.value.images?(n(),f(_,{key:2,class:"text-body1 fayz-content"},{default:o(()=>[i("img",{class:"maha",src:a.value.images,alt:""},null,8,ze)]),_:1})):u("",!0),i("div",be,[s(h,{color:"grey",size:"sm",icon:"far fa-comment",flat:"",round:""}),s(h,{color:"grey",size:"sm",icon:"fas fa-retweet",flat:"",round:""}),i("div",Fe,[s(h,{color:a.value.liked?"pink":"grey",size:"sm",icon:a.value.liked?"fas fa-heart":"far fa-heart",onClick:P,flat:"",round:""},null,8,["color","icon"]),a.value.liked>1?(n(),d("div",xe,c(a.value.liked),1)):u("",!0)]),a.value.admin?(n(),f(h,{key:0,onClick:H,color:"grey",size:"sm",icon:"fas fa-trash",flat:"",round:""})):(n(),d("div",Ce))])]),_:1})]),_:1}),a.value.MuhammadAmin||a.value.Fayzulloh?(n(),d("div",De,[F("liked: "),i("span",null,c(a.value.MuhammadAmin?"MuhammadAmin":""),1),a.value.MuhammadAmin&&a.value.Fayzulloh?(n(),d("span",Qe,",")):u("",!0),F(),i("span",null,c(a.value.Fayzulloh?"Fayzulloh":""),1)])):u("",!0)]),_:1})])):u("",!0),s(de,{class:"full-height flav absolute"},{default:o(()=>[i("div",Se,[i("div",{class:ae(["col col-5",{"col-10":g(I)}])},[s(le,{class:"new-fayz",style:{height:"80px"},autogrow:"","bottom-slots":"",modelValue:g(y),"onUpdate:modelValue":t[2]||(t[2]=e=>te(y)?y.value=e:y=e),placeholder:"\u041E\u0442\u0432\u0435\u0447\u0430\u0439 \u043D\u0430 \u0441\u043B\u043E\u0432\u0430.",counter:"",maxlength:"280"},{before:o(()=>[s(O,null,{default:o(()=>[i("img",{src:g(pe)},null,8,qe)]),_:1})]),_:1},8,["modelValue"]),i("div",Ie,[i("label",Me,[i("input",{type:"file",onChange:J,accept:"image/*, video/*"},null,32),Re])])],2),i("div",Ae,[s(h,{onClick:K,class:"q-mr-xlg",disable:g(q)||!g(y)&&!g(w)&&!g(p),unelevated:"","no-caps":"",rounded:"",color:"primary",label:"Fise"},null,8,["disable"])])]),s(se,{class:"devidor",size:"15px",color:"grey-2"}),s(E,null,{default:o(()=>[s(oe,{appear:"","enter-active-class":"animated fadeIn slow","leave-active-class":"animated fadeOut slow"},{default:o(()=>[(n(!0),d(U,null,ie(z.value,e=>(n(),f(M,{clickable:"false",key:e.id},{default:o(()=>[e.num==String(g(k).id)?(n(),d("div",Ne,[s(Q,{avatar:"",top:""},{default:o(()=>[s(O,{size:"xl"},{default:o(()=>[s(ne,{src:e.image},null,8,["src"])]),_:2},1024)]),_:2},1024),s(Q,null,{default:o(()=>[s(_,{class:"text-subtitle1 column"},{default:o(()=>[i("strong",null,c(e.nickname),1),i("span",Ve,c(e.name)+" \u2022 "+c(j(e.date)),1)]),_:2},1024),e.content?(n(),f(_,{key:0,class:"text-body1 fayz-content"},{default:o(()=>[F(c(e.content),1)]),_:2},1024)):u("",!0),e.video?(n(),f(_,{key:1,onClick:t[3]||(t[3]=A(()=>{},["prevent"])),class:"text-body1 maha fayz-content"},{default:o(()=>[i("video",{controls:"",class:"maha",src:e.video},null,8,Le)]),_:2},1024)):u("",!0),e.images?(n(),f(_,{key:2,class:"text-body1 fayz-content"},{default:o(()=>[i("img",{class:"maha",src:e.images,alt:""},null,8,je)]),_:2},1024)):u("",!0),i("div",Be,[s(h,{color:"grey",size:"sm",icon:"fas fa-retweet",flat:"",round:""}),i("div",Ee,[s(h,{color:e.liked?"pink":"grey",size:"sm",icon:e.liked?"fas fa-heart":"far fa-heart",onClick:A(r=>X(e),["prevent"]),flat:"",round:""},null,8,["color","icon","onClick"]),e.liked>1?(n(),d("div",Ue,c(e.liked),1)):u("",!0)]),e.admin?(n(),d("div",Oe)):(n(),f(h,{key:0,onClick:A(r=>Y(e),["prevent"]),color:"grey",size:"sm",icon:"fas fa-trash",flat:"",round:""},null,8,["onClick"]))])]),_:2},1024)])):u("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})],64))}};export{Ye as default};
