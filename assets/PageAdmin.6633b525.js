import{r as c,q as F,G as P,J as l,K as y,L as i,M as n,N as o,S as W,I as h,ah as $,ai as G,T as p,Q as k,aj as J,ak as K,U as H,V as X,O as w,R as Y,al as b,am as Q}from"./index.6907c00b.js";import{Q as Z,a as ee,b as R,c as C}from"./QItemLabel.8c38a0ab.js";import{Q as ae,f as te}from"./formatDistance.04543f57.js";import{Q as se}from"./QPage.f5fed0ea.js";import{q as S,a as V,c as q,o as B,d as x,b as le,e as L,u as oe,f as ie}from"./firebase.02bcd041.js";import{g as ne,r as de,u as ce,a as ue}from"./index.esm2017.601a6a60.js";import"./QScrollObserver.f842e0c0.js";const re={class:"q-py-lg q-px-md row items-center q-col-gutter-md"},me={class:"col"},ve=["src"],fe=["src"],pe={class:"gapp"},ge={class:"input-file"},_e=o("span",null,"Add file",-1),ye={class:"col col-shrink"},he=["src"],ke=["src"],we={class:"text-grey-7"},xe=["src"],be=["src"],Ce={class:"fayz-icons row justify-between q-mt-sm"},Ie={class:"likes-value"},De={key:0},Qe={key:1},Le={__name:"PageAdmin",setup(qe){c(null);let m=c("");const N=a=>te(a,new Date);let I=c(!1),g=c(null);const _=c([]);c(!1);let D=c(!0),u=c();const U=ne(),M=async a=>{const t=de(U,`videos/${a.name}`);return await ce(t,a),await ue(t)},j=async a=>{const t=L(x,"fayzs",a.id);await oe(t,{liked:a.MuhammadAmin?a.liked-1:a.liked+1,MuhammadAmin:!a.MuhammadAmin})};setInterval(()=>{localStorage.setItem("lastActiveM",Date.now())},100);const T=async()=>{if(m.value!==""||g.value||u.value){I.value=!1;let a={content:m.value,date:Date.now(),liked:0,image:D.value?"/images/logo.png":"/images/fayz.jpg",images:g.value,video:null,admin:D.value,nickname:d.value.nickname,name:d.value.name,MuhammadAmin:!1,Fayzulloh:!1};if(u.value&&(a.video=await M(u.value),u.value=null),D.value){const e=async()=>{d.value.image?a.image=d.value.image:(console.log("zhdi"),setTimeout(async()=>{await e()},100))};await e()}const t=await le(q(x,"fayzs"),a);console.log("Document written with ID: ",t.id)}else return null;m.value="",g.value=null,u.value=null,I.value=!1},z=async a=>{await ie(L(x,"fayzs",a.id))},O=a=>{const t=a.target.files[0];if(t){const e=new FileReader;e.onload=async()=>{t.type.startsWith("image")?(u.value=null,g.value=e.result):t.type.startsWith("video")&&(g.value=null,u.value=await M(u.value=a.target.files[0]))},e.readAsDataURL(t)}};F(()=>{const a=S(q(x,"fayzs"),V("date"));B(a,t=>{t.docChanges().forEach(e=>{let s=e.doc.data();if(s.id=e.doc.id,e.type==="added"&&(console.log("New fayz: ",s),_.value.unshift(s)),e.type==="modified"){console.log("Modified fayz: ",s);let r=_.value.findIndex(f=>f.id===s.id);Object.assign(_.value[r],s)}if(e.type==="removed"){console.log("Removed fayz: ",s);let r=_.value.findIndex(f=>f.id===s.id);_.value.splice(r,1)}})})});const d=c(),E=P(),A=()=>{E.push("/admin/Fayz")},v=c([]);return F(()=>{const a=S(q(x,"active"),V("date"));B(a,t=>{t.docChanges().forEach(e=>{let s=e.doc.data();if(s.id=e.doc.id,e.type==="added"&&(v.value.unshift(s),d.value=v.value[1]),e.type==="modified"){let r=v.value.findIndex(f=>f.id===s.id);Object.assign(v.value[r],s),r===1&&(d.value=v.value[1])}if(e.type==="removed"){let r=v.value.findIndex(f=>f.id===s.id);v.value.splice(r,1),r===1&&(d.value=v.value[1])}})})}),(a,t)=>(l(),y(se,{class:"relative-position"},{default:i(()=>[n(ae,{class:"full-width full-height absolute"},{default:i(()=>[o("div",re,[o("div",me,[n(W,{class:"new-fayz",autogrow:"","bottom-slots":"",modelValue:h(m),"onUpdate:modelValue":t[0]||(t[0]=e=>$(m)?m.value=e:m=e),placeholder:"What do you need?",counter:"",maxlength:"280"},G({_:2},[d.value?{name:"before",fn:i(()=>[d.value.image.includes("https")?(l(),p("video",{key:1,onClick:A,class:"dodemg",loop:"",autoplay:"",muted:"",src:d.value.image},null,8,fe)):(l(),p("img",{key:0,onClick:A,class:"dodemg",src:d.value.image},null,8,ve))]),key:"0"}:void 0]),1032,["modelValue"]),o("div",pe,[o("label",ge,[o("input",{type:"file",onChange:O,accept:"image/*, video/*"},null,32),_e])])]),o("div",ye,[n(k,{onClick:T,class:"q-mb-xlg",disable:h(I)||!h(m)&&!h(g)&&!h(u),unelevated:"","no-caps":"",rounded:"",color:"primary",label:"Fise"},null,8,["disable"])])]),n(J,{class:"devidor",size:"15px",color:"grey-2"}),n(Z,{separator:""},{default:i(()=>[n(K,{appear:"","enter-active-class":"animated fadeIn slow","leave-active-class":"animated fadeOut slow"},{default:i(()=>[(l(!0),p(X,null,H(_.value,e=>(l(),y(ee,{clickable:"",to:{name:"MessageT",params:{id:String(e.id)}},key:e.id,class:"fayz q-py-md"},{default:i(()=>[n(R,{avatar:"",top:""},{default:i(()=>[e.image.includes("https")?(l(),p("video",{key:1,class:"dodemg",loop:"",autoplay:"",muted:"",src:e.image},null,8,ke)):(l(),p("img",{key:0,class:"dodemg",src:e.image},null,8,he))]),_:2},1024),n(R,null,{default:i(()=>[n(C,{class:"text-subtitle1 column"},{default:i(()=>[o("strong",null,w(e.nickname),1),o("span",we,w(e.name)+" \u2022 "+w(N(e.date)),1)]),_:2},1024),e.content?(l(),y(C,{key:0,class:"text-body1 fayz-content"},{default:i(()=>[Y(w(e.content),1)]),_:2},1024)):b("",!0),e.video?(l(),y(C,{key:1,onClick:t[1]||(t[1]=Q(()=>{},["prevent"])),class:"text-body1 maha fayz-content"},{default:i(()=>[o("video",{controls:"",class:"maha",src:e.video},null,8,xe)]),_:2},1024)):b("",!0),e.images?(l(),y(C,{key:2,class:"text-body1 fayz-content"},{default:i(()=>[o("img",{class:"maha",src:e.images,alt:""},null,8,be)]),_:2},1024)):b("",!0),o("div",Ce,[n(k,{color:"grey",size:"sm",icon:"far fa-comment",flat:"",round:""}),n(k,{color:"grey",size:"sm",icon:"fas fa-retweet",flat:"",round:""}),o("div",Ie,[n(k,{color:e.liked?"pink":"grey",size:"sm",icon:e.liked?"fas fa-heart":"far fa-heart",onClick:Q(s=>j(e),["prevent"]),flat:"",round:""},null,8,["color","icon","onClick"]),e.liked>1?(l(),p("div",De,w(e.liked),1)):b("",!0)]),e.admin?(l(),y(k,{key:0,onClick:Q(s=>z(e),["prevent"]),color:"grey",size:"sm",icon:"fas fa-trash",flat:"",round:""},null,8,["onClick"])):(l(),p("div",Qe))])]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Le as default};
