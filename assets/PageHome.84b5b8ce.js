import{G as P,r as c,q as R,J as l,K as y,L as i,M as n,N as o,S as W,I as h,ah as $,ai as G,T as p,Q as k,aj as H,ak as J,U as K,V as X,O as w,R as Y,al as b,am as D}from"./index.6907c00b.js";import{Q as Z,a as ee,b as S,c as C}from"./QItemLabel.8c38a0ab.js";import{Q as ae,f as te}from"./formatDistance.04543f57.js";import{Q as se}from"./QPage.f5fed0ea.js";import{q as B,a as L,c as Q,o as M,d as x,b as le,e as N,u as oe,f as ie}from"./firebase.02bcd041.js";import{g as ne,r as de,u as ce,a as ue}from"./index.esm2017.601a6a60.js";import"./QScrollObserver.f842e0c0.js";const re={class:"q-py-lg q-px-md row items-center q-col-gutter-md"},me={class:"col"},ve=["src"],fe=["src"],pe={class:"gapp"},ge={class:"input-file"},_e=o("span",null,"Add file",-1),ye={class:"col col-shrink"},he=["src"],ke=["src"],we={class:"text-grey-7"},xe=["src"],be=["src"],Ce={class:"fayz-icons row justify-between q-mt-sm"},Fe={class:"likes-value"},Ie={key:0},De={key:1},Ne={__name:"PageHome",setup(Qe){const U=P();c(null);let r=c("");const A=a=>te(a,new Date);let g=c(null);const _=c([]);c(!1);let F=c(!1),m=c();const j=ne(),q=async a=>{const t=de(j,`videos/${a.name}`);return await ce(t,a),await ue(t)};let I=c(!1);const O=async a=>{const t=N(x,"fayzs",a.id);await oe(t,{liked:a.Fayzulloh?a.liked-1:a.liked+1,Fayzulloh:!a.Fayzulloh})};setInterval(()=>{localStorage.setItem("lastActiveF",Date.now())},100);const T=async()=>{if(r.value!==""||g.value||m.value){I.value=!0;let a={content:r.value,date:Date.now(),liked:0,image:F.value?"/images/logo.png":"",images:g.value,video:null,admin:F.value,nickname:d.value.nickname,name:d.value.name,MuhammadAmin:!1,Fayzulloh:!1};if(m.value&&(a.video=await q(m.value)),!F.value){const e=async()=>{d.value.image?a.image=d.value.image:(console.log("zhdi"),setTimeout(async()=>{await e()},100))};await e()}const t=await le(Q(x,"fayzs"),a);console.log("Document written with ID: ",t.id)}else return null;r.value="",g.value=null,m.value=null,I.value=!1},z=async a=>{await ie(N(x,"fayzs",a.id))},E=a=>{const t=a.target.files[0];if(t){const e=new FileReader;e.onload=async()=>{t.type.startsWith("image")?(m.value=null,g.value=e.result):t.type.startsWith("video")&&(g.value=null,m.value=await q(m.value=a.target.files[0]))},e.readAsDataURL(t)}};R(()=>{const a=B(Q(x,"fayzs"),L("date"));M(a,t=>{t.docChanges().forEach(e=>{let s=e.doc.data();if(s.id=e.doc.id,e.type==="added"&&_.value.unshift(s),e.type==="modified"){let u=_.value.findIndex(f=>f.id===s.id);Object.assign(_.value[u],s)}if(e.type==="removed"){let u=_.value.findIndex(f=>f.id===s.id);_.value.splice(u,1)}})})});const d=c(),v=c([]);R(()=>{const a=B(Q(x,"active"),L("date"));M(a,t=>{t.docChanges().forEach(e=>{let s=e.doc.data();if(s.id=e.doc.id,e.type==="added"&&(v.value.unshift(s),d.value=v.value[0]),e.type==="modified"){let u=v.value.findIndex(f=>f.id===s.id);Object.assign(v.value[u],s),u===0&&(d.value=v.value[0])}if(e.type==="removed"){let u=v.value.findIndex(f=>f.id===s.id);v.value.splice(u,1),u===0&&(d.value=v.value[0])}})})});const V=()=>{U.push("/Fayzulloh")};return(a,t)=>(l(),y(se,{class:"relative-position"},{default:i(()=>[n(ae,{class:"full-width full-height absolute"},{default:i(()=>[o("div",re,[o("div",me,[n(W,{class:"new-fayz",autogrow:"","bottom-slots":"",modelValue:h(r),"onUpdate:modelValue":t[0]||(t[0]=e=>$(r)?r.value=e:r=e),placeholder:"What do you need?",counter:"",maxlength:"280"},G({_:2},[d.value?{name:"before",fn:i(()=>[d.value.image.includes("https")?(l(),p("video",{key:1,onClick:V,class:"dodemg",loop:"",autoplay:"",muted:"",src:d.value.image},null,8,fe)):(l(),p("img",{key:0,onClick:V,class:"dodemg",src:d.value.image},null,8,ve))]),key:"0"}:void 0]),1032,["modelValue"]),o("div",pe,[o("label",ge,[o("input",{type:"file",onChange:E,accept:"image/*, video/*"},null,32),_e])])]),o("div",ye,[n(k,{onClick:T,class:"q-mb-lg",disable:h(I)||!h(r)&&!h(g)&&!h(m),unelevated:"","no-caps":"",rounded:"",color:"primary",label:"Fise"},null,8,["disable"])])]),n(H,{class:"devidor",size:"15px",color:"grey-2"}),n(Z,{separator:""},{default:i(()=>[n(J,{appear:"","enter-active-class":"animated fadeIn slow","leave-active-class":"animated fadeOut slow"},{default:i(()=>[(l(!0),p(X,null,K(_.value,e=>(l(),y(ee,{clickable:"",to:{name:"Message",params:{id:e.id}},key:e.id,class:"fayz q-py-md"},{default:i(()=>[n(S,{avatar:"",top:""},{default:i(()=>[e.image.includes("https")?(l(),p("video",{key:1,class:"dodemg",loop:"",autoplay:"",muted:"",src:e.image},null,8,ke)):(l(),p("img",{key:0,class:"dodemg",src:e.image},null,8,he))]),_:2},1024),n(S,null,{default:i(()=>[n(C,{class:"text-subtitle1 column"},{default:i(()=>[o("strong",null,w(e.nickname),1),o("span",we,w(e.name)+" \u2022 "+w(A(e.date)),1)]),_:2},1024),e.content?(l(),y(C,{key:0,class:"text-body1 fayz-content"},{default:i(()=>[Y(w(e.content),1)]),_:2},1024)):b("",!0),e.video?(l(),y(C,{key:1,onClick:t[1]||(t[1]=D(()=>{},["prevent"])),class:"text-body1 maha fayz-content"},{default:i(()=>[o("video",{controls:"",class:"maha",src:e.video},null,8,xe)]),_:2},1024)):b("",!0),e.images?(l(),y(C,{key:2,class:"text-body1 fayz-content"},{default:i(()=>[o("img",{class:"maha",src:e.images,alt:""},null,8,be)]),_:2},1024)):b("",!0),o("div",Ce,[n(k,{color:"grey",size:"sm",icon:"far fa-comment",flat:"",round:""}),n(k,{color:"grey",size:"sm",icon:"fas fa-retweet",flat:"",round:""}),o("div",Fe,[n(k,{color:e.liked?"pink":"grey",size:"sm",icon:e.liked?"fas fa-heart":"far fa-heart",onClick:D(s=>O(e),["prevent"]),flat:"",round:""},null,8,["color","icon","onClick"]),e.liked>1?(l(),p("div",Ie,w(e.liked),1)):b("",!0)]),e.admin?(l(),p("div",De)):(l(),y(k,{key:0,onClick:D(s=>z(e),["prevent"]),color:"grey",size:"sm",icon:"fas fa-trash",flat:"",round:""},null,8,["onClick"]))])]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Ne as default};
